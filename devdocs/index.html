<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Devdocs · PingPong.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="PingPong.jl logo"/></a><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><span class="tocitem">Introduction</span><ul><li><a class="tocitem" href="../">What is PingPong?</a></li></ul></li><li><a class="tocitem" href="../types/">Types</a></li><li><a class="tocitem" href="../strategy/">Strategies</a></li><li><span class="tocitem">Engine</span><ul><li><a class="tocitem" href="../engine/engine/">Executors</a></li><li><a class="tocitem" href="../engine/backtesting/">Backtesting</a></li><li><a class="tocitem" href="../engine/paper/">Paper</a></li></ul></li><li><a class="tocitem" href="../exchanges/">Exchanges</a></li><li><a class="tocitem" href="../data/">Data</a></li><li><span class="tocitem">Watchers</span><ul><li><a class="tocitem" href="../watchers/watchers/">Interface</a></li><li><input class="collapse-toggle" id="menuitem-7-2" type="checkbox"/><label class="tocitem" for="menuitem-7-2"><span class="docs-label">Apis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../watchers/apis/coingecko/">CoinGecko</a></li><li><a class="tocitem" href="../watchers/apis/coinpaprika/">CoinPaprika</a></li><li><a class="tocitem" href="../watchers/apis/coinmarketcap/">CoinMarketCap</a></li></ul></li></ul></li><li><a class="tocitem" href="../stats/">Stats</a></li><li><a class="tocitem" href="../optimization/">Optimization</a></li><li><a class="tocitem" href="../plotting/">Plotting</a></li><li><span class="tocitem">Misc</span><ul><li><a class="tocitem" href="../config/">Config</a></li><li><a class="tocitem" href="../disambiguation/">Disambiguation</a></li><li><a class="tocitem" href="../troubleshooting/">Troubleshooting</a></li><li class="is-active"><a class="tocitem" href>Devdocs</a><ul class="internal"><li><a class="tocitem" href="#Precompilations"><span>Precompilations</span></a></li><li><a class="tocitem" href="#Methods-invalidations"><span>Methods invalidations</span></a></li><li><a class="tocitem" href="#Customizations-and-the-type-hierarchy"><span>Customizations and the type hierarchy</span></a></li><li><a class="tocitem" href="#Dependency-graph"><span>Dependency graph</span></a></li><li><a class="tocitem" href="#Limit-orders-flowchart"><span>Limit orders flowchart</span></a></li><li><a class="tocitem" href="#Market-orders-flowchart"><span>Market orders flowchart</span></a></li></ul></li><li><a class="tocitem" href="../contacts/">Contacts</a></li></ul></li><li><span class="tocitem">Customizations</span><ul><li><a class="tocitem" href="../customizations/customizations/">Overview</a></li><li><a class="tocitem" href="../customizations/orders/">Orders</a></li><li><a class="tocitem" href="../customizations/backtest/">Backtester</a></li><li><a class="tocitem" href="../customizations/exchanges/">Exchanges</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../API/collections/">Collections</a></li><li><a class="tocitem" href="../API/data/">Data</a></li><li><a class="tocitem" href="../API/executors/">Engine</a></li><li><a class="tocitem" href="../API/instances/">Instances</a></li><li><a class="tocitem" href="../API/instruments/">Instruments</a></li><li><a class="tocitem" href="../API/misc/">Misc</a></li><li><a class="tocitem" href="../API/optimization/">Optimization</a></li><li><a class="tocitem" href="../API/pbar/">Pbar</a></li><li><a class="tocitem" href="../API/plotting/">Plotting</a></li><li><a class="tocitem" href="../API/prices/">Prices</a></li><li><a class="tocitem" href="../API/processing/">Processing</a></li><li><a class="tocitem" href="../API/stats/">Stats</a></li><li><a class="tocitem" href="../API/strategies/">Strategies</a></li><li><input class="collapse-toggle" id="menuitem-13-14" type="checkbox"/><label class="tocitem" for="menuitem-13-14"><span class="docs-label">Analysis</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../API/analysis/analysis/">Analysis</a></li><li><a class="tocitem" href="../API/analysis/mlong/">MLong</a></li><li><a class="tocitem" href="../API/analysis/mshort/">MShort</a></li><li><a class="tocitem" href="../API/analysis/mvp/">MVP</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Misc</a></li><li class="is-active"><a href>Devdocs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Devdocs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/panifie/PingPong.jl/blob/master/docs/src/devdocs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Precompilations"><a class="docs-heading-anchor" href="#Precompilations">Precompilations</a><a id="Precompilations-1"></a><a class="docs-heading-anchor-permalink" href="#Precompilations" title="Permalink"></a></h2><p>Functions that should be precompiled</p><ul><li>Python: <code>clearpath!</code></li><li>Data: <code>ZarrInstance</code>, <code>ZGroup</code>, <code>zopen</code>, <code>get_zgroup</code></li><li>Misc: <code>empty!(::Config)</code></li><li>CPython <code>__init__</code>(?)</li></ul><p>Precompilation can be skipped for some modules, by setting <code>JULIA_NOPRECOMP</code> env var:</p><pre><code class="language-julia hljs">ENV[&quot;JULIA_NOPRECOMP&quot;] = (:PingPong, :Scrapers, :Engine, :Watchers, :Plotting, :Stats)</code></pre><p>or use direnv, (see the <code>.envrc</code> in the repository). Setting <code>JULIA_NOPRECOMP=all</code> disables precompilation <em>entirely</em> for some packages, it should be used only when modifying low level pieces of the modules stack. When switching between <code>all</code>, and custom lists remember to purge the compile cache:</p><pre><code class="language-julia hljs">include(&quot;resolve.jl&quot;)
purge_compilecache() # If you pass a local package name it will only purge that package comp cache</code></pre><h2 id="Methods-invalidations"><a class="docs-heading-anchor" href="#Methods-invalidations">Methods invalidations</a><a id="Methods-invalidations-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-invalidations" title="Permalink"></a></h2><p>The sequence of <code>using ...</code> statements to load modules can be important to consider, although only for the first instance for a particular module is critical. That&#39;s because when a module is loaded, methods insertion can trigger invalidation. If you order the modules loading from the <em>most</em> likley to invalidate, to the <em>least</em> one, less methods will be invalidated and the top module will load faster. For example in case of modules that depend on the <code>Python</code>, making python the top most statemenet can improve loading times, e.g.:</p><pre><code class="language-julia hljs"># load invalidation heavy modules first
using Python
using Ccxt
# load lightweight modules later
using Timeticks
using Lang</code></pre><p>Invalidation heavy modules list:</p><ul><li>Python</li><li>Ccxt (starts the python async loop)</li><li>Data (depends on Zarr and DataFrames)</li><li>Plots (makie dependency)</li></ul><p>In general if one of our local package depends on some heavy package, the chances that it will trigger many methods invalidations is high. This is also why it is important to always add an external module to 1 and only 1 local package and use the local package as dependency to other local packages, e.g.:</p><p>We choose to make <code>DataFrames</code> a dependency to the local package <code>Data</code>, but we want to use the <code>DataFrames</code> module from our <code>Stats</code> package. We should <em>not</em> add <code>DataFrames</code> the deps of <code>Stats</code>, instead we <code>Data</code> and import <code>DataFrames</code> from <code>Data</code> like so:</p><pre><code class="language-julia hljs">module Stats

using Data.DataFrames

# ...
end</code></pre><h3 id="Adding-dependencies"><a class="docs-heading-anchor" href="#Adding-dependencies">Adding dependencies</a><a id="Adding-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-dependencies" title="Permalink"></a></h3><p>Only add a dependency to one of the subpackages, when using the same dependency from another subpackage, add the subpackage that already has that dependency instead of the dependency itself.</p><p>When adding <code>using</code> or <code>imports</code> statements inside packages you must consider their order. The rule of thumb is to always import from the <em>most downstream</em> package to the <em>most upstream</em>. This reduces the amount of invalidations happening as packages are inserted into the method tables.</p><h2 id="Customizations-and-the-type-hierarchy"><a class="docs-heading-anchor" href="#Customizations-and-the-type-hierarchy">Customizations and the type hierarchy</a><a id="Customizations-and-the-type-hierarchy-1"></a><a class="docs-heading-anchor-permalink" href="#Customizations-and-the-type-hierarchy" title="Permalink"></a></h2><p>If you look at the package <code>OrderTypes</code> (or <code>EventTypes</code>) there are multiple definition for dispatching functions on orders whether they are buy,sell,long,short. Care must be taken for ensuring that dispatching works as intended because multiple definitions that might trick you into thinking they are similar, they are not:</p><pre><code class="language-julia hljs">struct One{T} end
struct Two{T} end
TypeAlias1{A} = Two{&lt;:One}
TypeAlias2{A&lt;:One} = Two{A}</code></pre><p>If you parametrize on the alias, the type deref won&#39;t carry over the parameter restriction, so if you have another type <code>TypeAlias3{A&lt;:Two} = Two{A}</code> it will dispatch to the same func as <code>TypeAlias2</code> ignoring the <code>&lt;:One</code> and <code>&lt;:Two</code> restriction. As a rule of thumb, restrict subtyping to the right side to ensure dispatching works as intended.</p><div class="admonition is-warning"><header class="admonition-header">Testing dispatch while using Revise</header><div class="admonition-body"><p>Revise can trick you into thinking dispatching is working correctly while in practice you might have just redefined a new method on the same parameters, more over, because revise doesn&#39;t delete old method if still in use, it might look like dispatching is working, whereas some parts are using deleted methods that are not anymore in the code base. For this reason, when you notice inconsistencies, start from a fresh repl, and optionally purge the compile cache.</p></div></div><h2 id="Dependency-graph"><a class="docs-heading-anchor" href="#Dependency-graph">Dependency graph</a><a id="Dependency-graph-1"></a><a class="docs-heading-anchor-permalink" href="#Dependency-graph" title="Permalink"></a></h2><p>This shows a graph where the red circled packages are our own packages. <a href="../assets/PingPong-deps.png"><img src="../assets/PingPong-deps.png" alt="PingPong dependencies graph"/></a></p><h2 id="Limit-orders-flowchart"><a class="docs-heading-anchor" href="#Limit-orders-flowchart">Limit orders flowchart</a><a id="Limit-orders-flowchart-1"></a><a class="docs-heading-anchor-permalink" href="#Limit-orders-flowchart" title="Permalink"></a></h2><p><a href="../assets/limit-orders.png"><img src="../assets/limit-orders.png" alt="Limit Orders Flowchart"/></a></p><h2 id="Market-orders-flowchart"><a class="docs-heading-anchor" href="#Market-orders-flowchart">Market orders flowchart</a><a id="Market-orders-flowchart-1"></a><a class="docs-heading-anchor-permalink" href="#Market-orders-flowchart" title="Permalink"></a></h2><p><a href="../assets/market-orders.png"><img src="../assets/market-orders.png" alt="Market Orders Flowchart"/></a></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../troubleshooting/">« Troubleshooting</a><a class="docs-footer-nextpage" href="../contacts/">Contacts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 25 July 2023 11:17">Tuesday 25 July 2023</span>. Using Julia version 1.10.0-alpha1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
